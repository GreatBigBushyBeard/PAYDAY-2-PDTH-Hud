pdth_hud.textures = {}

pdth_hud.textures.portraits = {}

pdth_hud.textures.portraits["fallback"] = {}
pdth_hud.textures.portraits["fallback"].bg = {
	texture = "guis/textures/pd2/masks",
	texture_rect = {
		0, 
        780, 
        192, 
        390
	}
}

pdth_hud.textures.portraits["fallback"].health = {
	texture = "guis/textures/pd2/masks",
	texture_rect = {
		0, 
        0, 
        192, 
        390
	}
}

pdth_hud.textures.portraits["fallback"].armor = {
	texture = "guis/textures/pd2/masks",
	texture_rect = {
		0, 
        390, 
        192, 
        390
	}
}

pdth_hud.textures.portraits["fallback"].tm = {
	texture = "guis/textures/pd2/masks",
	texture_rect = {
		0,
        1170,
        192,
        192
	}
}

pdth_hud.textures.portraits.teammate = {}

pdth_hud.textures.portraits.teammate.health = {
    texture = "guis/textures/hud_icons",
	texture_rect = {
		264, 
		240, 
		12, 
		48
	}
}

pdth_hud.textures.portraits.teammate.armor = {
    texture = "guis/textures/hud_icons",
	texture_rect = {
		252, 
		240, 
		12, 
		48
	}
}

pdth_hud.textures.portraits.teammate.bg = {
    texture = "guis/textures/hud_icons",
	texture_rect = {
		240, 
		240, 
		12, 
		48
	}
}

pdth_hud.textures.bullets = {}

pdth_hud.textures.bullets[2] = {}

pdth_hud.textures.bullets[2].assault_rifle = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		0, 
		8, 
		32
	}
}
--[[pdth_hud.textures.bullets[2].bow = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		0, 
		8, 
		32
	}
}]]--
pdth_hud.textures.bullets[2].shotgun = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		32, 
		0, 
		16, 
		32
	}
}
--[[pdth_hud.textures.bullets[2].saw = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		57, 
		0, 
		0, 
		35
	}
}]]--
pdth_hud.textures.bullets[2].lmg = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		48, 
		0, 
		4, 
		32
	}
}
pdth_hud.textures.bullets[2].minigun = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		48, 
		0, 
		4, 
		32
	}
}

pdth_hud.textures.bullets[2].snp = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		0, 
		8, 
		32
	}
}
pdth_hud.textures.bullets[2].grenade_launcher = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		16, 
		0, 
		16, 
		32
	}
}

pdth_hud.textures.bullets[2].akimbo = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		37, 
		8, 
		24
	}
}
pdth_hud.textures.bullets[2].smg = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		37, 
		8, 
		24
	}
}
pdth_hud.textures.bullets[2].pistol = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		37, 
		8, 
		24
	}
}


pdth_hud.textures.bullets[3] = {}

pdth_hud.textures.bullets[3].assault_rifle = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		91, 
		0, 
		8, 
		32
	}
}
pdth_hud.textures.bullets[3].shotgun = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		72, 
		0, 
		16, 
		32
	}
}
--[[pdth_hud.textures.bullets[3].bow = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		0, 
		0, 
		8, 
		32
	}
}]]--
pdth_hud.textures.bullets[3].minigun = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		48, 
		0, 
		4, 
		32
	}
}

--[[pdth_hud.textures.bullets[3].saw = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		57, 
		0, 
		0, 
		35
	}
}]]--
pdth_hud.textures.bullets[3].lmg = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		48, 
		0, 
		4, 
		32
	}
}
pdth_hud.textures.bullets[3].snp = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		91, 
		0, 
		8, 
		32
	}
}
pdth_hud.textures.bullets[3].grenade_launcher = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		16, 
		0, 
		16, 
		32
	}
}
pdth_hud.textures.bullets[3].akimbo = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		103, 
		4, 
		8, 
		24
	}
}
pdth_hud.textures.bullets[3].smg = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		103, 
		4, 
		8, 
		24
	}
}
pdth_hud.textures.bullets[3].pistol = {
	texture = "guis/textures/ammocounter",
	texture_rect = {
		103, 
		4, 
		8, 
		24
	}
}

pdth_hud.textures.weapons = {}

pdth_hud.textures.weapons.ak47 = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		416, 
		288, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.ak74 = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		416, 
		288, 
		48, 
		48
	}
}

pdth_hud.textures.weapons.akm = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		416, 
		288, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.akm_gold = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		416, 
		288, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.new_m14 = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		336,
		0,
		48,
		48
	}
}
pdth_hud.textures.weapons.g3 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		30, 
		1350, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.galil = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		966, 
		1144, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.fal = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		782, 
		1147, 
		163, 
		166
	}
}
pdth_hud.textures.weapons.s552 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		405, 
		1147, 
		164, 
		166
	}
}
pdth_hud.textures.weapons.famas = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		785, 
		944, 
		164, 
		166
	}
}
pdth_hud.textures.weapons.l85a2 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		972, 
		395, 
		161, 
		166
	}
}
pdth_hud.textures.weapons.m16 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		30, 
		946, 
		170, 
		166
	}
}
pdth_hud.textures.weapons.assault_rifle = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		48, 
		0, 
		48, 
		48
	}	
}
pdth_hud.textures.weapons.r870 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		29, 
		1538, 
		167, 
		166
	}
}
pdth_hud.textures.weapons.ksg = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		965, 
		1346, 
		170, 
		166
	}
}
pdth_hud.textures.weapons.spas12 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		779, 
		577, 
		173, 
		166
	}
}
pdth_hud.textures.weapons.benelli = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		594, 
		752, 
		165, 
		166
	}	
}
pdth_hud.textures.weapons.huntsman = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		969, 
		750, 
		167, 
		166
	}	
}
pdth_hud.textures.weapons.saiga = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		404, 
		1349, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.shotgun = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		96, 
		0, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.saw = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		780, 
		17, 
		168, 
		166
	}	
}
pdth_hud.textures.weapons.rpk = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		218, 
		1538, 
		169, 
		166
	}
}
pdth_hud.textures.weapons.hk21 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		403, 
		946, 
		171, 
		166
	}	
}
pdth_hud.textures.weapons.m249 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		220, 
		752, 
		166, 
		166
	}	
}


pdth_hud.textures.weapons.lmg = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		384, 
		0, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.m95 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		780, 
		1535, 
		164, 
		166
	}
}
pdth_hud.textures.weapons.msr = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		779, 
		1349, 
		168, 
		166
	}
}
pdth_hud.textures.weapons.mosin = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		970, 
		575, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.r93 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		591, 
		1350, 
		169, 
		166
	}
}
pdth_hud.textures.weapons.snp = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		336, 
		0, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.grenade_launcher = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		222, 
		1350, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.jowi = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		224, 
		19, 
		160, 
		166
	}
}
pdth_hud.textures.weapons.x_b92fs = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		33, 
		19, 
		159,			
		166
	}
}
pdth_hud.textures.weapons.x_1911 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		407, 
		19, 
		160, 
		166
	}
}
pdth_hud.textures.weapons.x_deagle = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		590, 
		19, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.akimbo = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		33, 
		19, 
		159,			
		166
	}
}
pdth_hud.textures.weapons.striker = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		405, 
		1539, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.judge = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		221, 
		579, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.serbu = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		402, 
		754, 
		174, 
		166
	}
}
pdth_hud.textures.weapons.new_raging_bull = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		221, 
		205, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.uzi = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		965, 
		1535, 
		170, 
		166
	}
}
pdth_hud.textures.weapons.m45 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		589, 
		1538, 
		169, 
		166
	}
}
pdth_hud.textures.weapons.new_mp5 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		592, 
		1146, 
		163, 
		166
	}
}
pdth_hud.textures.weapons.p90 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		222, 
		1148, 
		162, 
		166
	}
}
pdth_hud.textures.weapons.scorpion = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		30, 
		1147, 
		162, 
		166
	}
}
pdth_hud.textures.weapons.mp9 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		971, 
		944, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.m1928 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		596, 
		946, 
		165, 
		166
	}
}
pdth_hud.textures.weapons.tec9 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		224, 
		948, 
		163, 
		166
	}
}
pdth_hud.textures.weapons.akmsu = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		32, 
		754, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.sterling = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		593, 
		579, 
		163, 
		166
	}
}
pdth_hud.textures.weapons.olympic = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		405, 
		581, 
		164, 
		166
	}
}
pdth_hud.textures.weapons.mp7 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		970, 
		17, 
		163, 
		166
	}
}
pdth_hud.textures.weapons.mac10 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		784, 
		752, 
		163, 
		166
	}	
}
pdth_hud.textures.weapons.cobray = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		784, 
		752, 
		163, 
		166
	}	
}

pdth_hud.textures.weapons.smg = {
	texture = "guis/textures/hud_icons",
	texture_rect = {
		144, 
		0, 
		48, 
		48
	}
}
pdth_hud.textures.weapons.b92fs = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		33, 
		205, 
		159, 
		166
	}
}
pdth_hud.textures.weapons.c96 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		404, 
		205, 
		167, 
		166
	}
}
pdth_hud.textures.weapons.glock_17 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		594, 
		205, 
		162, 
		166
	}
}
pdth_hud.textures.weapons.g22c = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		782, 
		205, 
		163, 
		166
	}
}
pdth_hud.textures.weapons.g26 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		970, 
		201, 
		161, 
		166
	}
}
pdth_hud.textures.weapons.colt_1911 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		31, 
		399, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.deagle = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		222, 
		399, 
		166, 
		166
	}
}
pdth_hud.textures.weapons.ppk = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		402, 
		399, 
		171, 
		166
	}
}
pdth_hud.textures.weapons.usp = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		589, 
		399, 
		168, 
		166
	}
}
pdth_hud.textures.weapons.p226 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		782, 
		399, 
		164, 
		166
	}
}
pdth_hud.textures.weapons.glock_18c = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		27, 
		579, 
		170, 
		166
	}
}
pdth_hud.textures.weapons.pistol = {
	texture = "guis/textures.weapons/hud_icons",
	texture_rect = {	
		368, 
		288, 
		48, 
		48
	}
}	
pdth_hud.textures.weapons.vhs = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1163, 
		15, 
		165, 
		166
	}
}	
pdth_hud.textures.weapons.hs2000 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1155, 
		205, 
		177, 
		166
	}
}	
pdth_hud.textures.weapons.aug = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1160, 
		398, 
		169, 
		166
	}
}	
pdth_hud.textures.weapons.ak5 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1146, 
		943, 
		182, 
		166
	}
}	
pdth_hud.textures.weapons.g36 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1150, 
		752, 
		181, 
		166
	}
}	
pdth_hud.textures.weapons.new_m14 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1145, 
		577, 
		181, 
		166
	}
}	
pdth_hud.textures.weapons.scar = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {	
		1147, 
		1146, 
		175, 
		166
	}
}	
pdth_hud.textures.weapons.m134 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		1151, 
		1347, 
		181, 
		166
	}	
}

pdth_hud.textures.weapons.rpg7 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		1151, 
		1535, 
		177, 
		166
	}
}
pdth_hud.textures.weapons.b682 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		211, 
		1712, 
		180, 
		166
	}
}
pdth_hud.textures.weapons.m32 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		18, 
		1711, 
		172, 
		166
	}
}
pdth_hud.textures.weapons.flamethrower_mk2 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		392, 
		1711, 
		181, 
		166
	}
}
pdth_hud.textures.weapons.aa12 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		586, 
		1709, 
		180, 
		167
	}
}
pdth_hud.textures.weapons.peacemaker = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		20, 
		1888, 
		187, 
		167
	}
}
pdth_hud.textures.weapons.winchester1874 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		961, 
		1707, 
		192, 
		167
	}
}
pdth_hud.textures.weapons.bow = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		1153, 
		1709, 
		170, 
		167
	}
}
pdth_hud.textures.weapons.mateba = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		397, 
		1887, 
		185, 
		167
	}
}

pdth_hud.textures.weapons.asval = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		584, 
		1887, 
		183, 
		167
	}
}

pdth_hud.textures.weapons.sub2000 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		778, 
		1886, 
		171, 
		167
	}
}


pdth_hud.textures.weapons.polymer = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		1156, 
		1887, 
		170, 
		167
	}
}

pdth_hud.textures.weapons.wa2000 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		24, 
		2076, 
		177, 
		167
	}
}

pdth_hud.textures.weapons.hunter = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		215, 
		2080,
		170, 
		167
	}
}

pdth_hud.textures.weapons.baka = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		595, 
		2080,
		165, 
		164
	}
}

pdth_hud.textures.weapons.arblast = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		780, 
		2082,
		165, 
		164
	}
}

pdth_hud.textures.weapons.frankish = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		970, 
		2083,
		165, 
		164
	}
}

pdth_hud.textures.weapons.long = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		1153, 
		1709, 
		170, 
		167
	}
}

pdth_hud.textures.weapons.par = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		23, 
		2266, 
		168, 
		167
	}
}

pdth_hud.textures.weapons.model70 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		213, 
		2267, 
		173, 
		167
	}
}

pdth_hud.textures.weapons.sparrow = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		402, 
		2268, 
		164, 
		167
	}
}

pdth_hud.textures.weapons.m37 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		593, 
		2269, 
		168, 
		167
	}
}

pdth_hud.textures.weapons.china = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		780, 
		2269, 
		171, 
		167
	}
}

pdth_hud.textures.weapons.sr2 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		970, 
		2267, 
		165, 
		167
	}
}

pdth_hud.textures.weapons.x_sr2 = {
	texture = "guis/textures/upgrade_images",
	texture_rect = {
		1153, 
		2268, 
		166, 
		167
	}
}

function pdth_hud.textures:get_icon_data(icon_id)
	local icon = pdth_hud.textures[icon_id] and pdth_hud.textures[icon_id].texture or icon_id
	local texture_rect = pdth_hud.textures[icon_id] and pdth_hud.textures[icon_id].texture_rect or {
		384, 
		260, 
		64, 
		130
	}
	return icon, texture_rect
end

function pdth_hud.textures:get_bullet_texture(category)
    local option = pdth_hud.Options.HUD.Bullet
    
    local bulletTexture
    
    if self.bullets[option] then
        if self.bullets[option][category] then
            bulletTexture = self.bullets[option][category]
        else
            if self.bullets[2][category] then
                bulletTexture = self.bullets[2][category]
            end
        end
    end
    
    if bulletTexture then
        return bulletTexture.texture, bulletTexture.texture_rect
    end
    
    return false, false
end

function pdth_hud.textures:get_weapon_texture(weapon_id, category)
	local rectangle = pdth_hud.textures.weapons[weapon_id] and pdth_hud.textures.weapons[weapon_id].texture_rect or pdth_hud.textures.weapons[category] and pdth_hud.textures.weapons[category].texture_rect or {
		0,
		0,
		0,
		0
	}
	local texture = pdth_hud.textures.weapons[weapon_id] and pdth_hud.textures.weapons[weapon_id].texture or pdth_hud.textures.weapons[category] and pdth_hud.textures.weapons[category].texture or "guis/textures/upgrade_images"
	
    return texture, rectangle
end

function pdth_hud.textures:get_portrait_texture(character, section, main_player)
    if not main_player and section ~= "tm" and pdth_hud.Options.HUD.OGTMHealth then
        local icon = pdth_hud.textures.portraits.teammate[section].texture
        local texture_rect = pdth_hud.textures.portraits.teammate[section].texture_rect
        return icon, texture_rect
    end
    
	local order = deep_clone(pdth_hud.portrait_options)
    
    table.sort(order, function(a, b)
        return pdth_hud.Options.portraits[a] < pdth_hud.Options.portraits[b]
    end)
    
	local portrait_id = "default"
	for i, portrait in pairs(order) do
		if portrait and pdth_hud.textures.portraits[portrait] and pdth_hud.textures.portraits[portrait][character] then
			portrait_id = portrait
			break
		end
	end
	
	local icon = pdth_hud.textures.portraits[portrait_id][character] and pdth_hud.textures.portraits[portrait_id][character][section] and pdth_hud.textures.portraits[portrait_id][character][section].texture or pdth_hud.textures.portraits["default"][character] and pdth_hud.textures.portraits["default"][character][section] and pdth_hud.textures.portraits["default"][character][section].texture or pdth_hud.textures.portraits["fallback"][section].texture or nil
	local texture_rect = pdth_hud.textures.portraits[portrait_id][character] and pdth_hud.textures.portraits[portrait_id][character][section] and pdth_hud.textures.portraits[portrait_id][character][section].texture_rect or pdth_hud.textures.portraits["default"][character] and pdth_hud.textures.portraits["default"][character][section] and pdth_hud.textures.portraits["default"][character][section].texture_rect or pdth_hud.textures.portraits["fallback"][section].texture_rect or nil
    
	return icon, texture_rect
end

function pdth_hud.textures:ProcessAddon(data)
    if data.portraits then
        for _, portait_set in pairs(data.portraits) do
            local name = portait_set.name
            local display_name = portait_set.display_name
            local main_texture = portait_set.main_texture
            pdth_hud.portrait_options[#pdth_hud.portrait_options + 1] = name
            if display_name then
                Hooks:Add("LocalizationManagerPostInit", "PDTHHudPortrait" .. name, function(loc)
                    LocalizationManager:add_localized_strings({
                        ["pdth_" .. name] = display_name
                    })
                end)
            end
            pdth_hud.textures.portraits[name] = {}
            for _, portrait in pairs(portait_set.portraits) do
                local character_id = portrait.character_id
                pdth_hud.textures.portraits[name][character_id] = {}
                for ptype, rect in pairs(portrait.texture_rects) do
                    pdth_hud.textures.portraits[name][character_id][ptype] = {
                        texture = portait_set.texture or main_texture,
                        texture_rect = rect
                    }
                end
            end
        end
    end
end

pdth_hud:LoadAddons()